# Package Manager
* [Package Manager란?](#Package-Manager란?)
* npm
* [yarn](#yarn)

## Package Manager란?
패키지 설치, 업데이트, 수정, 삭제, 의존성 관리 등을 편리하고 안전하게 수행하기 위한 툴

### package란?
library가 코드 작성을 위해 사용되는 코드 묶음이라면, package는 코드의 배포를 위해 사용되는 코드의 묶음이다.
따라서 패키지는 경우에 따라 라이브러리를 포함할 수도 있으며, 일반적으로 라이브러리나 실행 파일(executable)을 포함한다.
패키지는 다음 3가지 정보를 가지고 있는 코드의 배포 단위이다.
* 컴파일한 소프트웨어의 바이너리(binary)
* 환경 설정(configuration)에 관련된 정보
* 의존(dependency)에 관련된 정보

### package manager의 기능
* 패키지의 dependency 관리
* 패키지의 보안관리 ㅡ 신뢰할 수 있고(authenticity), 손상되지 않음(integrity)을 보장
* 여러 패키지를 기능에 따라 그룹으로 묶어 정리
* 패키지 압축 해제
* Software repository로부터 패키지를 찾고, 다운로드하고, 설치하고, 업데이트하는 역할

### Package Manager 종류
* 패키지 매니저는 운영체제와 프로그래밍 언어에서 사용되는 툴이다.
* Ubuntu 운영체제의 apt(Advanced Package Tool)가 대표적인 운영체제 패키지 매니저의 예다.
* 예를 들어 콘솔을 사용한 sudo apt-get install 명령어를 통해 패키지를 설치할 수 있다.
* Python과 PHP, Node.js 등 많은 프로그래밍 언어들은 각각 자신만의 패키지 매니저와 software repository를 가지고 있다.
* 여러 종류의 패키지 매니저와 software repository를 가진 언어도 존재한다. (Node.js, Java, Ruby...)

| Lananguage | Package Manager   | Software Repository |
|------------|-------------------|---------------------|
| Python     | pip               | PyPI                |
| Node.js    | npm, yarn         | npm, yarn           |
| Java       | Maven, Gradle     | Maven               |
| Ruby       | RubyGems, Bundler | RubyGems, Bundler   |
| PHP        | Composer          | Packagist           |

## npm

## yarn
* 페이스북, 구글 tilde의 엔지니어 그룹에서 만듬

### yarn 설치
`https://classic.yarnpkg.com/en/docs/install/#mac-stable`에서 다운로드  
또는
`npm install -g yarn`
대부분 `npm`으로 설치함
설치한 위치 확인
```
# Windows
where yarn
# Linux or macOS
which yarn
```
### yarn 명령어
**npm install**
* `npm install`: package.json 파일 안에 정의된 dependencies을 `node_modules`폴더 안에 설치한다.

**yarn add**
* 사용법
    * `yarn add [package-name]`: 특정 패키지 설치
    * `yarn add [package-name@1.2.3]`: 특정 버전의 패키지 설치
    * `yarn add [package-name@tag]`: 특정 태그가 달린 패키지 설치
* 패키지를 하나 콕찝어서 설치하고 싶을 때 사용
* 실행 시 `package.json`과 `yarn.lock` 파일 업데이트 됨

**yarn remove**
* 사용법: `yarn remove [package-name]`
* 해당 패키지를 프로젝트에서 삭제
* 실행 시 `package.json`과 `yarn.lock` 파일에서도 제거됨

**yarn config와 .yarnrc**
* yarn config 명령을 통해 Yarn에서 참조하는 설정 파일을 지정할 수 있음
* 아래와 같이 npm 패키지 저장소의 URL을 변경하거나 라이센스를 지정하는 경우를 말한다.
```
$ yarn config set registry 'https://registry.yarnpkg.com'
$ yarn config set init-license MIT
$ yarn config list
$ yarn config set ssl-strict false
```
프로젝트의 로컬에서는 아래와 같이 .yarnrc 파일을 통해 별도의 명령 없이 config list를 관리할 수 있다.
```
# (in .yarnrc파일)
registry: 'https://registry.yarnpkg.com'
init-license: 'MIT'
```
**yarn check**
* 패키지 버전에 따른 의존 패키지들이 프로젝트에서 유효한지 체크
* 즉, 현재의 package.json이 yarn.lock과 일치하는지 확인하는 것
* `yarn check` 명령 후에 위와 같이 `warning`, `error`를 만난다면 의존 패키지의 버전을 조정할 필요가 있습니다.
**yarn outdated**
* 업데이트가 필요한 모듈이 정리되어 출력
* `Current`는 프로젝트에 현재 설치된 버전
* `Wanted`는 package.json에 지정한 패키지의 버전에서 호환성을 보장하는 버전. 즉, yarn upgrade를 통해 변경 되는 버전
* `Latest`는 패키지의 현재의 최신 버전. Major 업데이트가 필요한 패키지는 붉은색으로 표시됨
**npm-check**
* `yarn outdated`이 좋긴 한데 일일히 설치해야함..귀찮아..
* `npm-check`는 Iteractive한 UI를 터미널에서 제공해 조금 더 쉽게 패키지의 버전을 관리해준다.
* https://www.npmjs.com/package/npm-check
* 설치: `yarn global install npm-check`
* 확인: `npm-check -u`




### yarn.lock
* 패키지를 설치하다보면 `package.json`에 정의한 정보보다 더 많은 정보가 필요하다.  
* 어떤 개발자는 macOS에서 설치하고, 어떤 개발자는 Windows에서 패키지를 설치하다보면 버전이 달라지기도한다.  
또는 1년 전에 설치했던 패키지 버전과 최근에 설치한 버전이 안맞기도 한다.  
* 즉, 시스템 마다 `yarn install`되는 시점에 따라 패키지 버전이 다를 수 있다.
* 그래서 정확이 어떤 버전을 설치하고 어디서 설치하라는 추가 정보를 명시하는 파일이 `yarn.lock`파일이다.  
yarn.lock파일을 열어보면:
```
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1
package-1@^1.0.0:
  version "1.0.3"
  resolved "https://registry.npmjs.org/package-1/-/package-1-1.0.3.tgz#a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0"
package-2@^2.0.0:
  version "2.0.1"
  resolved "https://registry.npmjs.org/package-2/-/package-2-2.0.1.tgz#a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0"
  dependencies:
    package-4 "^4.0.0"
package-3@^3.0.0:
  version "3.1.9"
  resolved "https://registry.npmjs.org/package-3/-/package-3-3.1.9.tgz#a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0"
  dependencies:
    package-4 "^4.5.0"
```
* `yarn.lock`파일은 add/upgrade/remove dependencies 할 때 자동적으로 추가/변경된다.
* 꼭 source control(e.g. git or mercurial)에 올려서 다른 개발자들과 공유해야한다.
    * gitignore 파일에 추가하면 안됨
* 프로젝트의 라이브러리 매니저는 꼭 `yarn.lock`파일을 관리해야한다.
* 절대 직접 수정하지 않는다.

## Reference
* [Package Manager](https://aahc.tistory.com/14#recentEntries)